CREATE DATABASE delilahResto;
USE delilahResto;

CREATE TABLE usuario(
	id INT NOT NULL AUTO_INCREMENT,
	nombreUsuario VARCHAR(255) NOT NULL UNIQUE,
	nombreYApellido VARCHAR(255) NOT NULL,
	email VARCHAR(255) NOT NULL UNIQUE,
	telefono INT,
	direccion VARCHAR(255) NOT NULL,
	contrasena VARCHAR(255) NOT NULL,  
	esAdmin BOOLEAN NOT NULL,
	PRIMARY KEY (id)
);

CREATE TABLE productos(
	id INT NOT NULL AUTO_INCREMENT,
	foto VARCHAR(255) NOT NULL,
	nombre VARCHAR(255) NOT NULL,
	precio FLOAT NOT NULL,
	PRIMARY KEY(id) 
);

CREATE TABLE pedido(
	id INT NOT NULL AUTO_INCREMENT,
	estado ENUM('NUEVO', 'CONFIRMADO', 'PREPARANDO', 'ENVIADO', 'CANCELADO', 'ENTREGADO') NOT NULL,
	formaPago ENUM('TARJETA', 'EFECTIVO') NOT NULL,
	usuario_id INT NOT NULL,
	PRIMARY KEY (id),
	FOREIGN KEY (usuario_id) REFERENCES usuario(id) ON DELETE CASCADE
);

CREATE TABLE detallepedido(
	id INT NOT NULL AUTO_INCREMENT,
	producto_id INT NOT NULL,
	pedido_id INT NOT NULL,
	PRIMARY KEY (id),
	FOREIGN KEY (producto_id) REFERENCES productos(id) ON DELETE CASCADE ON UPDATE,
	FOREIGN KEY (pedido_id) REFERENCES pedido(id) ON DELETE CASCADE
);
